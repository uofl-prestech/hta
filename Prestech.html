<!DOCTYPE html>
<html>

<head>
    <title>OOP Task Sequence Selections</title>
    <meta http-equiv="x-ua-compatible" content="ie=9">
    <link rel="stylesheet" href="./jquery-ui-1.11.4.custom/jquery-ui.css">
    <link rel="stylesheet" href="style/jquery.jscrollpane.css">
    <script src="./jquery-1.11.1.min.js"></script>
    <script src="./jquery-ui-1.11.4.custom/jquery-ui.min.js"></script>
    <script type="text/javascript" src="script/jquery.mousewheel.js"></script>
    <script type="text/javascript" src="script/jquery.jscrollpane.min.js"></script> 
    <script src="./HTAfunctions.vbs" type="text/vbscript" language="vbscript"></script>
    <script src="./bitlockerFunctions.vbs" type="text/vbscript" language="vbscript"></script>
    <script type="text/vbscript" language="vbscript">
        window.resizeTo 1024,768
        window.moveTo 400, 200
    </script>
    <link rel="stylesheet" href="Prestech.css">
    <hta:application applicationname="OOP Task Sequence Selections" border="thin" innerborder="no" caption="yes" scroll="no"
        windowstate="normal"></hta:application>
</head>

<body>
    <div id="container">
        <div id="header" class="on-load">
            <h1>// PRESTECH HTA</h1>
        </div>
        <div id="main" class="on-load">
            <div class="navigation-bar">
                <ul>
                    <li id="button-osd" class="first button-nav">
                        <img src="images/osd final.png" class="icon">
                        <span>OSD</span>
                    </li>
                    <li id="button-flushfill" class="button-nav">
                        <img src="images/flush and fill final.png" class="icon">
                        <span>Flush and Fill</span>
                    </li>
                    <li id="button-dism" class="button-nav">
                        <img src="images/DISM final.png" class="icon">
                        <span>DISM</span>
                    </li>
                    <li id="button-usmt" class="button-nav">
                        <img src="images/usmt final.png" class="icon">
                        <span>USMT</span>
                    </li>
                    <li id="button-software" class="button-nav">
                        <img src="images/software install.png" class="icon">
                        <span>Software Install</span>
                    </li>
                    <li id="button-tools" class="button-nav">
                        <img src="images/tools-icon.png" class="icon">
                        <span>Tools</span>
                    </li>
                </ul>
                <div class="">
                    <button class="button-exithome">Home</button>
                    <button class="button-exithome" onclick="vbscript:ButtonExitClick()">Exit</button>
                </div>
            </div>

            <div id="content">
                <div class="category-header">
                    <button class="smallButton" id="button-ShowAll">Expand</button>
                    <button class="smallButton" id="button-HideAll">Collapse</button>
                    <button class="smallButton usmtStates" id="button-ScanState">Scan</button>
                    <button class="smallButton usmtStates" id="button-LoadState">Load</button>
                    <h4 id="header-landing" class="header-text">OOP Task Sequence Selections</h4>
                    <h4 id="header-osd" class="header-text">Operating System Deployment</h4>
                    <h4 id="header-flushfill" class="header-text">OS Upgrade with User Data Migration: "Flush and Fill"</h4>
                    <h4 id="header-dism" class="header-text">Deployment Image Servicing and Management</h4>
                    <h4 id="header-usmt" class="header-text">User State Migration Tool</h4>
                    <h4 id="header-software" class="header-text">Software Installation</h4>
                    <h4 id="header-tools" class="header-text">Troubleshooting Tools</h4>
                </div>
                <!--Landing Page-->
                <div id="page-landing" class="pages">
                    <div id="landing-page-input" class="input-div"></div>
                </div>

                <!--OSD Page-->
                <div id="page-osd" class="pages">
                    <div id="osd-input" class="input-div">
                        <ul class="accordion ui-accordion">
                            <li class="osd-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>OSD Options
                                </h3>
                                <div id="osd-step1" class="ui-widget-content"><input type="checkbox" name="OSD"> Format Drive and Deploy Image (OSD)? </div>
                            </li>
                            <li class="osd-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter Computer
                                    Name
                                </h3>
                                <div id="osd-step2" class="ui-widget-content"> Computer Name: &nbsp&nbsp <input type="text" id="osdCompName" name="compName"> <br></div>
                            </li>
                            <li class="osd-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Select Software
                                    to Install
                                </h3>
                                <div id="osd-step3" class="ui-widget-content">
                                    <input type="checkbox" id="osdAdobeReaderDC" class="software-osd" name="OSDAdobeReaderDC">Adobe
                                        Reader DC<br>
                                    <input type="checkbox" id="osdAdobeAcrobatProXI" class="software-osd" name="OSDAdobeAcrobatProXI">Adobe
                                        Acrobat Pro XI<br>
                                    <input type="checkbox" id="osdChrome" class="software-osd" name="OSDChrome">Chrome 58<br>
                                    <input type="checkbox" id="osdFileMaker" class="software-osd" name="OSDFileMaker">FileMaker Pro 16<br>
                                    <input type="checkbox" id="osdOffice2016" class="software-osd" name="OSDOffice2016">Office 2016 (32 Bit)<br>
                                </div>
                            </li>
                            <button class="button" id="button-finish" onclick="vbscript:ButtonFinishClick()">Launch OSD</button>
                        </ul>
                    </div>
                </div>

                <!-- Flush and Fill Page -->
                <div id="page-flushfill" class="pages">
                    <div id="fnf-input" class="input-div">
                        <ul class="accordion ui-accordion">
                            <li class="fnf-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Flush and Fill
                                    Options</h3>
                                <div id="fnf-step1" class="ui-widget-content">
                                    <input type="checkbox" name="dismCheckBox"> Create Backup Image (DISM)? <br>
                                    <input type="checkbox" name="scanStateCheckBox"> Save User Data (USMT Scanstate)? <br>
                                    <input type="checkbox" name="fnfOSD"> Format Drive and Deploy Image (OSD)? <br>
                                    <input type="checkbox" name="loadStateCheckBox"> Restore User Data after OSD (USMT Loadstate)?
                                    <br>
                                </div>
                            </li>
                            <li class="fnf-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Get Bitlocker
                                    Info
                                </h3>
                                <div id="fnf-step2" class="ui-widget-content">
                                    <button class="button button-bl-info" id="fnf-bl-info"><img src="images/bitlocker-icon.png" class="icon-tools">Bitlocker Info</button><br>
                                </div>
                            </li>
                            <li class="fnf-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    drive letter of the Windows partition
                                </h3>
                                <div id="fnf-step3" class="ui-widget-content">
                                    <span>Drive Letter: &nbsp&nbsp </span><input class="drive-input" name="fnfWindowsDrive"
                                        type="Text" maxlength="1" size="1">
                                </div>
                            </li>
                            <li class="fnf-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    Recovery Key to unlock Bitlocker
                                </h3>
                                <div id="fnf-step4" class="ui-widget-content">
                                    <input name="fnfBlKey" type="Text" maxlength="100" size="35" value="524040-163009-565158-446017-323081-469150-421465-452760">
                                    <button class="button button-bl-unlock" id="fnf-bl-unlock"><img src="images/bitlocker-unlock1.png" class="icon-tools">Bitlocker Unlock</button>
                                </div>
                            </li>
                            <li class="fnf-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    username of the user we are copying data for
                                </h3>
                                <div id="fnf-step5" class="ui-widget-content">
                                    <span>Username: &nbsp&nbsp </span>
                                    <input name="fnfUsername" type="Text" size="15">
                                </div>
                            </li>
                            <li class="fnf-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    drive letter of the External USB drive where the data will be stored
                                </h3>
                                <div id="fnf-step6" class="ui-widget-content">
                                    <span>Drive Letter: &nbsp&nbsp </span><input class="drive-input" name="fnfDrive" type="Text"
                                        maxlength="1" size="1">
                                </div>
                            </li>
                            <li class="fnf-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter Computer
                                    Name
                                </h3>
                                <div id="fnf-step7" class="ui-widget-content"> Computer Name: &nbsp&nbsp <input type="text" name="fnfCompName"> <br></div>
                            </li>
                            <li class="fnf-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Select Software
                                    to Install
                                </h3>
                                <div id="fnf-step8" class="ui-widget-content">
                                    <input type="checkbox" class="software-osd" name="fnfAdobeReaderDC"> Adobe Reader DC<br>
                                    <input type="checkbox" class="software-osd" name="fnfAdobeAcrobatProXI"> Adobe Acrobat Pro XI<br>
                                    <input type="checkbox" class="software-osd" name="fnfChrome"> Chrome 58<br>
                                    <input type="checkbox" class="software-osd" name="fnfFileMaker"> FileMaker Pro 16<br>
                                    <input type="checkbox" class="software-osd" name="fnfOffice2016"> Office 2016 (32 Bit)<br>
                                </div>
                            </li>
                        </ul>
                        <div id="fnf-begin">
                            <button class="button" id="fnf-capture" name="fnfCapture"><img src="images/DISM final.png" class="icon-tools">Begin!</button>
                        </div>
                    </div>
                </div>

                <!--DISM Page-->
                <div id="page-dism" class="pages">
                    <div id="dism-input" class="input-div">
                        <ul class="accordion ui-accordion">
                            <li class="dism-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Get Bitlocker
                                    Info
                                </h3>
                                <div id="dism-step1" class="ui-widget-content">
                                    <button class="button button-bl-info" id="bl-info"><img src="images/bitlocker-icon.png" class="icon-tools">Bitlocker Info</button>
                                </div>
                            </li>
                            <li class="dism-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    drive letter of the Windows partition to be imaged
                                </h3>
                                <div id="dism-step2" class="ui-widget-content">
                                    <span>Drive Letter: &nbsp&nbsp </span><input class="drive-input" name="windowsDrive"
                                        type="Text" maxlength="1" size="1">
                                </div>
                            </li>
                            <li class="dism-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    Recovery Key to unlock Bitlocker
                                </h3>
                                <div id="dism-step3" class="ui-widget-content">
                                    <input name="blKey" type="Text" maxlength="100" size="35" value="524040-163009-565158-446017-323081-469150-421465-452760">
                                    <button class="button button-bl-unlock" id="bl-unlock"><img src="images/bitlocker-unlock-icon.png" class="icon-tools">Bitlocker Unlock</button>
                                </div>
                            </li>
                            <li class="dism-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    username of the user we are copying data for
                                </h3>
                                <div id="dism-step4" class="ui-widget-content">
                                    <span>Username: &nbsp&nbsp </span>
                                    <input name="dismUsername" type="Text" size="15">
                                </div>
                            </li>
                            <li class="dism-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    drive letter of the External USB drive where the image will be stored
                                </h3>
                                <div id="dism-step5" class="ui-widget-content">
                                    <span>Drive Letter: &nbsp&nbsp </span><input class="drive-input" name="dismDrive" type="Text"
                                        maxlength="1" size="1">
                                </div>
                            </li>
                        </ul>
                        <div id="dism-begin">
                            <button class="button" id="dism-capture" name="capture"><img src="images/DISM final.png" class="icon-tools">Capture Image</button>
                        </div>
                    </div>
                </div>

                <!--USMT Page-->
                <div id="page-usmt" class="pages">
                    <div id="usmt-input" class="input-div">
                        <ul class="accordion ui-accordion">
                            <li class="usmt-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Get Bitlocker
                                    Info
                                </h3>
                                <div id="usmt-step1" class="ui-widget-content">
                                    <button class="button button-bl-info" id="usmt-bl-info"><img src="images/bitlocker-icon.png" class="icon-tools">Bitlocker Info</button><br>
                                </div>
                            </li>
                            <li class="usmt-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    drive letter of the Windows partition
                                </h3>
                                <div id="usmt-step2" class="ui-widget-content">
                                    <span>Drive Letter: &nbsp&nbsp </span><input class="drive-input" name="usmtWindowsDrive"
                                        type="Text" maxlength="1" size="1">
                                </div>
                            </li>
                            <li class="usmt-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    Recovery Key to unlock Bitlocker
                                </h3>
                                <div id="usmt-step3" class="ui-widget-content">
                                    <input name="usmtBlKey" type="Text" maxlength="100" size="35" value="524040-163009-565158-446017-323081-469150-421465-452760">
                                    <button class="button button-bl-unlock" id="usmt-bl-unlock"><img src="images/bitlocker-unlock-icon.png" class="icon-tools">Bitlocker Unlock</button>
                                </div>
                            </li>
                            <li class="usmt-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter username
                                    of the user we are copying data for
                                </h3>
                                <div id="usmt-step4" class="ui-widget-content">
                                    <span>Username: &nbsp&nbsp </span>
                                    <input id="usmt-username-input" name="usmtUsername" type="Text" size="15">
                                </div>
                            </li>
                            <li class="usmt-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Enter the
                                    drive letter of the External USB drive where the USMT data will be stored
                                </h3>
                                <div id="usmt-step5" class="ui-widget-content">
                                    <span id="driveLetter">Drive Letter: &nbsp&nbsp </span>
                                    <input id="usmt-drive-input" class="drive-input" name="usmtDrive" type="Text" maxlength="1" size="1"><br><br>
                                </div>
                            </li>
                            </ul>
                            <div id="usmt-begin">
                                <button class="button" id="run-usmt" name="runUSMT"><img src="images/bitlocker-unlock-icon.png" class="icon-tools">Run USMT</button><br><br>
                            </div>
                        </div>
                    </div>

                <!--Software Install Page-->
                <div id="page-software-install" class="pages">
                    <div id="software-input" class="input-div">
                        <ul class="accordion ui-accordion">
                            <li class="osd-steps">
                                <h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons">
                                    <span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Select Software to Install
                                </h3>
                                <div class="ui-widget-content">
                                    <input type="checkbox" class="software-osd" name="OSDAdobeReaderDC">Adobe Reader DC<br>
                                    <input type="checkbox" class="software-osd" name="OSDAdobeAcrobatProXI">Adobe Acrobat Pro XI<br>
                                    <input type="checkbox" class="software-osd" name="OSDChrome">Chrome 58<br>
                                    <input type="checkbox" class="software-osd" name="OSDFileMaker">FileMaker Pro 16<br>
                                    <input type="checkbox" class="software-osd" name="OSDOffice2016">Office 2016 (32 Bit)<br>
                                </div>
                            </li>
                        </ul>
                    </div>

                <!--Troubleshooting Tools Page-->
                <div id="page-tools" class="pages">
                    <div class="input-div">
                        <div class="tools-button-bar">
                            <button class="button" id="button-bitlocker" onclick="vbscript:BitlockerInfo()"><img src="images/bitlocker-icon.png" class="icon-tools">Bitlocker Info</button>
                            <button class="button" id="button-cmdprompt" name="cmdWindow" onclick="vbscript:cmdPrompt()"><img src="images/command-prompt-icon.png" class="icon-tools">Command Prompt</button>
                            <button class="button" id="button-explorer" name="explorer" onclick="vbscript:explorer()"><img src="images/explorer-icon.png" class="icon-tools">Explorer ++</button>
                            <button class="button" id="button-logviewer" name="logViewer" onclick="vbscript:logViewer()"><img src="images/cmtrace-icon.png" class="icon-tools">Log Viewer</button>
                            <button class="button" id="button-pingtest" name="ping" onclick="vbscript:pingTest()"><img src="images/ping-icon.png" class="icon-tools">Ping Test</button>
                        </div>
                    </div>
                    <div id="general-output">.general-output</div>
                    <!--    End content    -->
                </div>
                <!--    End main    -->
            </div>
            <!--    End container    -->
        </div>
</body>

<script language="JavaScript">
    $(document).ready(function () {
        $('.pages').css('display', 'none');
        $('.header-text').css('display', 'none');
        $('.usmtStates').css('display', 'none');
        $('#page-landing').css('display', 'inline-block');
        $('#header-landing').css('display', 'inline');

        $('.accordion h3').click(function () {
            $(this).next().toggle('fast');
            $(this).children().toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s");
            return false;
        }).next().hide();

        listDrives()
    });

    $('#button-ShowAll').on('click', function () {
        $('.ui-widget-content').show('fast');
        $('.ui-widget-content').prev().children().removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-s");
    });
    $('#button-HideAll').on('click', function () {
        $('.ui-widget-content').hide('fast');
        $('.ui-widget-content').prev().children().removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e");
    });

    $('#button-ShowAll').on('click', function () {
        $('.ui-widget-content').show('fast');
    });
    $('#button-HideAll').on('click', function () {
        $('.ui-widget-content').hide('fast');
    });
    $('.button-nav').on('click', function () {
        $('.pages').css('display', 'none');
        $('.header-text').css('display', 'none');
    });
    $('.button-output').on('click', function () {
        $("#general-output").css('visibility', 'visible');
    });
    $('#button-osd').on('click', function () {
        $('#page-osd').css('display', 'inline-block');
        $('#header-osd').css('display', 'inline');
        // TPMCheck();
    });
    $('#button-flushfill').on('click', function () {
        $('#page-flushfill').css('display', 'inline-block');
        $('#header-flushfill').css('display', 'inline');
        if ($("#fnf-username-input").length == 0 || $("#usmt-username-input").length == 0) {
            enumUsers()
        }
    });
    $('#button-dism').on('click', function () {
        $('#page-dism').css('display', 'inline-block');
        $('#header-dism').css('display', 'inline');
    });
    $('#button-usmt').on('click', function () {
        $('#page-usmt').css('display', 'inline-block');
        $('#header-usmt').css('display', 'inline');
        $('.usmtStates').css('display', 'block');
        if ($("#fnf-username-input").length == 0 || $("#usmt-username-input").length == 0) {
            enumUsers()
        }
    });
    $('#button-software').on('click', function () {
        $('#page-software-install').css('display', 'inline-block');
        $('#header-software').css('display', 'inline');
    });
    $('#button-tools').on('click', function () {
        $('#page-tools').css('display', 'inline-block');
        $('#header-tools').css('display', 'inline');
    });
    $('#button-home').on('click', function () {
        $('#page-landing').css('display', 'inline-block');
        $('#header-landing').css('display', 'inline');
    });
    // $(function(){
    //     $('.scroll-pane').jScrollPane();
    // });

    // $(function () {
    //     $("#dismOutput").dialog({ 
    //         autoOpen: false,
    //         width: 700,
    //         height: 500,
    //         modal: true });
    // });
    $('#button-bitlocker').on('click', function () {
        BitlockerInfo();
    });
    $('.button-bl-info').on('click', function () {
        BitlockerInfo();
    });
    $('.button-bl-unlock').on('click', function () {
        BitlockerUnlock();
    });
    $('#dism-capture').on('click', function () {
        dismCapture();
    });
    $('#run-usmt').on('click', function () {
        usmtScanstate("true");
    });
    $('#fnf-capture').on('click', function () {
        runFlushFill();
    });
    $("#usmt-drive-input, #usmt-username-input").keyup(function () {
        usmtScanstate("false");
    });

    $(".on-load").delay(200).animate({ "opacity": "1" }, 700);

</script>

</html>